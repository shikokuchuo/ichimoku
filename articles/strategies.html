<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ichimoku">
<title>ichimoku: Beyond Visualization - Quantitative Strategies • ichimoku</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ichimoku: Beyond Visualization - Quantitative Strategies">
<meta property="og:description" content="ichimoku">
<meta property="og:image" content="https://shikokuchuo.net/ichimoku/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ichimoku</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/reference.html">ichimoku: Cloud Charts - The Reference Manual</a>
    <a class="dropdown-item" href="../articles/strategies.html">ichimoku: Beyond Visualization - Quantitative Strategies</a>
    <a class="dropdown-item" href="../articles/utilities.html">ichimoku: Auxiliary Functions</a>
    <a class="dropdown-item" href="../articles/xoanda.html">ichimoku: The OANDA fxTrade API</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/shikokuchuo/ichimoku/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://shikokuchuo.net/">
    <span class="fa fa-cube"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ichimoku: Beyond Visualization - Quantitative Strategies</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/shikokuchuo/ichimoku/blob/HEAD/vignettes/strategies.Rmd" class="external-link"><code>vignettes/strategies.Rmd</code></a></small>
      <div class="d-none name"><code>strategies.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shikokuchuo.net/ichimoku/">ichimoku</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>There are multiple ways to work with Ichimoku Kinko Hyo strategies
using the ichimoku R package.</p>
<p>First and foremost is visually, and the functions for visualization
are described in the <a href="reference.html">reference
vignette</a>.</p>
<p>However, for performing analysis on the data directly, complications
of the ichimoku system can quickly become apparent. The Chikou span in
particular poses a challenge as the position of this indicator needs to
be mapped in relation to the chart elements 26 periods previously,
however this then affects trading decisions at the present point in
time.</p>
<p>The ‘strategy layer’ of the ichimoku package aims to prepare the data
in a standardized format for ease of further analysis. Short strategy
summaries are generated automatically, but are designed to serve as a
quick reference rather than a replacement for a full backtest using a
package such as ‘PerformanceAnalytics’.</p>
<p>The <code><a href="../reference/autostrat.html">autostrat()</a></code> function is used to further facilitate
idea generation, and leverages the computational capability of R to
simultaneously test all valid indicator combinations.</p>
<p>Risk warning: past results are not necessarily indicative of future
performance, and should always be considered within the context of a
comprehensive risk analysis framework.</p>
</div>
<div class="section level2">
<h2 id="working-with-strategies">Working with Strategies<a class="anchor" aria-label="anchor" href="#working-with-strategies"></a>
</h2>
<div class="section level3">
<h3 id="use-ichimoku">1. Use <code>ichimoku()</code><a class="anchor" aria-label="anchor" href="#use-ichimoku"></a>
</h3>
<p>To create an ichimoku object from the price data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated OHLC pricing data is assigned to data frame 'TKR':</span></span>
<span><span class="va">TKR</span> <span class="op">&lt;-</span> <span class="va">sample_ohlc_data</span></span>
<span><span class="va">cloud</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ichimoku.html">ichimoku</a></span><span class="op">(</span><span class="va">TKR</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a--simple-strategies-using-strat">2a. Simple strategies using <code>strat()</code><a class="anchor" aria-label="anchor" href="#a--simple-strategies-using-strat"></a>
</h3>
<p>To test a simple strategy with an indicator condition of the form
‘long (or short) while c1 &gt; c2’.</p>
<p>Here ‘c1’ and ‘c2’ are the quoted column names of the ichimoku object
representing either candlestick values e.g. ‘close’ or cloud values
e.g. ‘tenkan’.</p>
<p>Note: the indicator condition remains of the form c1 &gt; c2 even for
short trades. Hence please take care, for example, when inverting ‘long
while close &gt; tenkan’ to ‘short while close &lt; tenkan’, this should
actually be formulated as ‘short while tenkan &gt; close’.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strat.html">strat</a></span><span class="op">(</span><span class="va">cloud</span>, c1 <span class="op">=</span> <span class="st">"cloudB"</span>, c2 <span class="op">=</span> <span class="st">"kijun"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">strat</span><span class="op">[</span><span class="fl">100</span><span class="op">:</span><span class="fl">105</span>, <span class="op">]</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  ichimoku   [ more() to display more rows | look() to inspect attributes ]</span></span>
<span><span class="co">#&gt;   object</span></span>
<span><span class="co">#&gt;                      open  high   low close cd tenkan  kijun senkouA senkouB</span></span>
<span><span class="co">#&gt; 2020-05-19 23:00:00 122.7 122.7 121.8 122.4 -1 121.05 123.90 125.675  124.85</span></span>
<span><span class="co">#&gt; 2020-05-20 23:00:00 122.4 122.6 121.1 121.9 -1 121.05 123.90 125.675  124.85</span></span>
<span><span class="co">#&gt; 2020-05-21 23:00:00 121.9 123.7 121.7 123.3  1 121.40 123.80 125.675  124.85</span></span>
<span><span class="co">#&gt; 2020-05-24 23:00:00 123.3 124.0 123.0 124.0  1 121.55 123.80 125.675  124.85</span></span>
<span><span class="co">#&gt; 2020-05-25 23:00:00 124.2 124.3 124.0 124.1 -1 121.75 123.65 125.975  124.85</span></span>
<span><span class="co">#&gt; 2020-05-26 23:00:00 124.1 124.1 123.4 123.9 -1 122.25 123.65 126.475  124.85</span></span>
<span><span class="co">#&gt;                     chikou  cloudT cloudB cond posn txn        logret</span></span>
<span><span class="co">#&gt; 2020-05-19 23:00:00  135.1 125.675 124.85    1    1   0 -0.0024479816</span></span>
<span><span class="co">#&gt; 2020-05-20 23:00:00  135.6 125.675 124.85    1    1   0 -0.0040933336</span></span>
<span><span class="co">#&gt; 2020-05-21 23:00:00  134.5 125.675 124.85    1    1   0  0.0114193737</span></span>
<span><span class="co">#&gt; 2020-05-24 23:00:00  134.3 125.675 124.85    1    1   0  0.0072727593</span></span>
<span><span class="co">#&gt; 2020-05-25 23:00:00  135.9 125.975 124.85    1    1   0 -0.0008054773</span></span>
<span><span class="co">#&gt; 2020-05-26 23:00:00  135.2 126.475 124.85    1    1   0 -0.0016129036</span></span>
<span><span class="co">#&gt;                           slogret          ret         sret</span></span>
<span><span class="co">#&gt; 2020-05-19 23:00:00 -0.0024479816 -0.002444988 -0.002444988</span></span>
<span><span class="co">#&gt; 2020-05-20 23:00:00 -0.0040933336 -0.004084967 -0.004084967</span></span>
<span><span class="co">#&gt; 2020-05-21 23:00:00  0.0114193737  0.011484824  0.011484824</span></span>
<span><span class="co">#&gt; 2020-05-24 23:00:00  0.0072727593  0.007299270  0.007299270</span></span>
<span><span class="co">#&gt; 2020-05-25 23:00:00 -0.0008054773 -0.000805153 -0.000805153</span></span>
<span><span class="co">#&gt; 2020-05-26 23:00:00 -0.0016129036 -0.001611604 -0.001611604</span></span></code></pre></div>
<p>The use of <code><a href="../reference/strat.html">strat()</a></code> returns an augmented ichimoku object.
The printout above of a slice of the object (rows 100 to 105) shows that
the following columns are appended:</p>
<ul>
<li>
<code>$cond</code>: ‘1’ if the indicator condition is met at the
close of the the time period (note: if the indicator condition involves
chikou span, the comparison will be of past periods)</li>
<li>
<code>$posn</code>: ‘1’ represents that a position is held during
this time period (i.e. from the ‘open’ to the ‘close’)</li>
<li>
<code>$txn</code>: ‘1’ represents a transaction to enter a new
position, ‘-1’ represents a transaction to exit an existing position.
All transactions are assumed to happen at the ‘open’ of the respective
period</li>
<li>
<code>$logret</code>: the log returns from the ‘open’ price of the
period to the ‘open’ price of the next period. For the avoidance of
doubt, ‘log returns’ means the natural logarithm of the difference
between the prices</li>
<li>
<code>$slogret</code>: the log returns for the strategy. It is
simply logret * posn, i.e. the returns where a position is held</li>
<li>
<code>$ret</code>: the discrete returns from the ‘open’ price of the
period to the ‘open’ price of the next period. For the avoidance of
doubt, this is calculated as e raised to the power of ‘logret’ minus
1</li>
<li>
<code>$sret</code>: the discrete returns for the strategy. It is
simply ret * posn, i.e. the returns where a position is held</li>
</ul>
<p>Note: the following assumptions apply to all strategies:</p>
<ul>
<li>confirmation of whether a condition is satisfied is received at the
‘close’ of a particular period</li>
<li>a transaction is initiated at the immediately following ‘open’</li>
<li>all transactions are conducted at opening prices</li>
</ul>
<p>All events are aligned to their correct time periods, which are taken
to be from the ‘open’ to the ‘close’ inclusive of that period:</p>
<ul>
<li>‘cond’ refers to if the condition is satisfied at the ‘close’ of the
period</li>
<li>‘posn’ refers to whether a position is held at the ‘close’ of the
period</li>
<li>‘txn’ refers to if there has been a transaction during the period
(occurring at the ‘open’)</li>
</ul>
</div>
<div class="section level3">
<h3 id="b--complex-strategies-using-strat">2b. Complex strategies using <code>strat()</code><a class="anchor" aria-label="anchor" href="#b--complex-strategies-using-strat"></a>
</h3>
<p>Complex strategies can be created by <code><a href="../reference/strat.html">strat()</a></code> simply by
supplying ‘c3’ and ‘c4’ to the function. These are the quoted column
names of the ichimoku object that form the second part of the indicator
condition.</p>
<p>To create the desired complex strategy, the argument ‘type’ must also
be specified. By default this is set to 2, which means the strategy will
be a combined strategy formulated as ‘c1 &gt; c2 &amp; c3 &gt; c4’,
where both conditions must be satisfied.</p>
<p>If ‘type’ is set to 3, the strategy will be formulated as an
asymmetric strategy ‘c1 &gt; c2 x c3 &gt; c4’, where ‘c1 &gt; c2’ is
used as a position entry indicator, and ‘c3 &gt; c4’ as a position exit
indicator.</p>
<ul>
<li>Note: when the strategy is, for example, ‘close &gt; tenkan x tenkan
&gt; close’, this is equivalent to the simple strategy ‘close &gt;
tenkan’ but not identical due to the strict inequality. In the former,
the situation ‘close = tenkan’ does not trigger a position exit but in
the latter it does</li>
</ul>
</div>
<div class="section level3">
<h3 id="view-strategy-summary-with-summary">3. View strategy summary with <code>summary()</code><a class="anchor" aria-label="anchor" href="#view-strategy-summary-with-summary"></a>
</h3>
<p>A summary of the strategy is saved as an attribute to the ichimoku
object and can be accessed by the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method for
ichimoku objects.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">strat</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        [,1]               </span></span>
<span><span class="co">#&gt; Strategy               "cloudB &gt; kijun"   </span></span>
<span><span class="co">#&gt; ---------------------  "----------"       </span></span>
<span><span class="co">#&gt; Strategy cuml return % 14.09              </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0741             </span></span>
<span><span class="co">#&gt; Periods in market      46                 </span></span>
<span><span class="co">#&gt; Total trades           3                  </span></span>
<span><span class="co">#&gt; Average trade length   15.33              </span></span>
<span><span class="co">#&gt; Trade success %        100                </span></span>
<span><span class="co">#&gt; Worst trade ret %      3.4                </span></span>
<span><span class="co">#&gt; ---------------------  "----------"       </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   5.53               </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0302             </span></span>
<span><span class="co">#&gt; Periods in market      178                </span></span>
<span><span class="co">#&gt; ---------------------  "----------"       </span></span>
<span><span class="co">#&gt; Direction              "long"             </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00</span></span>
<span><span class="co">#&gt; End                    2020-12-23         </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"</span></span></code></pre></div>
<p>The summary is designed to provide a quick overview of whether a
strategy is effective / desirable:</p>
<ul>
<li>Strategy returns are compared with the benchmark, which is simply
holidng a position throughout the period</li>
<li>Comparing returns combined with total periods in the market can help
determine if the strategy is substantially different from just taking
market risk</li>
<li>Total trades along with average trade length can be used to filter
out undesirable strategies that over-trade</li>
<li>Trade success % helps to characterise the consistency of the
strategy or whether it relies on a small percentage of outsize
returns</li>
<li>The return of the worst-performing trade provides a measure of
downside risk</li>
</ul>
<p>See <a href="#strategy-summary-specification">strategy summary
specification</a> for details of the reported measures.</p>
</div>
<div class="section level3">
<h3 id="visualize-by-calling-plot-or-iplot-">4. Visualize by calling <code>plot()</code> or
<code>iplot()</code>.<a class="anchor" aria-label="anchor" href="#visualize-by-calling-plot-or-iplot-"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">strat</span>, theme <span class="op">=</span> <span class="st">"dark"</span><span class="op">)</span></span></code></pre></div>
<p><img src="strategies_files/figure-html/plot-1.png" width="672"></p>
<p>The periods where the strategy results in a market position are now
shaded on the ichimoku cloud chart. The strategy is also printed as the
chart subtitle (if not otherwise specified).</p>
<p>To view the original chart without the strategy, simply pass the
argument <code>strat = FALSE</code> when calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> or
<code><a href="../reference/iplot.html">iplot()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="combine-strategies-using-stratcombine">5. Combine strategies using <code>stratcombine()</code><a class="anchor" aria-label="anchor" href="#combine-strategies-using-stratcombine"></a>
</h3>
<p><code><a href="../reference/stratcombine.html">stratcombine()</a></code> can be used to create custom combined
strategies from existing strategies contained in ichimoku objects ‘s1’
and ‘s2’ to form ‘s1 &amp; s2’.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strat.html">strat</a></span><span class="op">(</span><span class="va">cloud</span>, <span class="st">"kijun"</span>, <span class="st">"tenkan"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newstrat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stratcombine.html">stratcombine</a></span><span class="op">(</span><span class="va">strat</span>, <span class="va">strat2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">newstrat</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        [,1]                             </span></span>
<span><span class="co">#&gt; Strategy               "cloudB &gt; kijun &amp; kijun &gt; tenkan"</span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Strategy cuml return % 11.53                            </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0613                           </span></span>
<span><span class="co">#&gt; Periods in market      27                               </span></span>
<span><span class="co">#&gt; Total trades           3                                </span></span>
<span><span class="co">#&gt; Average trade length   9                                </span></span>
<span><span class="co">#&gt; Trade success %        100                              </span></span>
<span><span class="co">#&gt; Worst trade ret %      1.78                             </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   5.53                             </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0302                           </span></span>
<span><span class="co">#&gt; Periods in market      178                              </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Direction              "long"                           </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00              </span></span>
<span><span class="co">#&gt; End                    2020-12-23                       </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"</span></span></code></pre></div>
<p>Note: rather than combining simple strategies using
<code><a href="../reference/stratcombine.html">stratcombine()</a></code>, it is preferable to supply all 4 arguments
‘c1’, ‘c2’, ‘c3’, and ‘c4’ directly to <code><a href="../reference/strat.html">strat()</a></code> to generate
a strategy of ‘c1 &gt; c2 &amp; c3 &gt; c4’.</p>
</div>
<div class="section level3">
<h3 id="further-backtesting-and-returns-analysis">6. Further backtesting and returns analysis<a class="anchor" aria-label="anchor" href="#further-backtesting-and-returns-analysis"></a>
</h3>
<p>The strategy returns are saved within the ichimoku object in the
columns ‘slogret’ (strategy log returns) and ‘sret’ (strategy discrete
returns).</p>
<p>The benchmark returns for all periods are saved as ‘logret’ (log
returns) and ‘ret’ (discrete returns).</p>
<p>As the ichimoku object inherits the ‘xts’ class, these columns may be
fed directly into other econometrics or time series analysis packages
such as ‘PerformanceAnalytics’, as per the example below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/braverock/PerformanceAnalytics" class="external-link">PerformanceAnalytics</a></span><span class="op">)</span></span>
<span><span class="co"># To chart performance comparison of strategy vs benchmark, daily returns and drawdowns</span></span>
<span><span class="fu">charts.PerformanceSummary</span><span class="op">(</span><span class="va">strat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sret"</span>, <span class="st">"ret"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># For a table detailing drawdowns, including depth, length of recovery etc.</span></span>
<span><span class="fu">table.Drawdowns</span><span class="op">(</span><span class="va">strat</span><span class="op">[</span>, <span class="st">"sret"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-strategies-and-ml">Advanced Strategies and ML<a class="anchor" aria-label="anchor" href="#advanced-strategies-and-ml"></a>
</h2>
<div class="section level3">
<h3 id="autostrat">
<code>autostrat()</code><a class="anchor" aria-label="anchor" href="#autostrat"></a>
</h3>
<p>The analytic capability of R can be leveraged to generate and
evaluate all possible strategies. This function is designed for
simplicity and can be called on an ichimoku object without any
additional arguments. The optional arguments it does take are limited
to:</p>
<ul>
<li>
<code>n</code> [default 8] number of strategies to return</li>
<li>
<code>dir</code> [default ‘long’] trade direction ‘long’ or
‘short’</li>
<li>
<code>level</code> [default 1] to return simple strategies. For
complex strategies, set <code>level = 2</code> to return combined
strategies of the form ‘s1 &amp; s2’ or <code>level = 3</code> to return
asymmetric strategies of the form ‘s1 x s2’</li>
<li>
<code>quietly</code> if set to TRUE, will suppress printing of
additional output to the console and return quietly</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/autostrat.html">autostrat</a></span><span class="op">(</span><span class="va">cloud</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        [,1]                [,2]               </span></span>
<span><span class="co">#&gt; Strategy               "senkouB &gt; tenkan"  "cloudB &gt; tenkan"  </span></span>
<span><span class="co">#&gt; ---------------------  "----------"        "----------"       </span></span>
<span><span class="co">#&gt; Strategy cuml return % 17.49               16.08              </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0906              0.0838             </span></span>
<span><span class="co">#&gt; Periods in market      63                  51                 </span></span>
<span><span class="co">#&gt; Total trades           3                   3                  </span></span>
<span><span class="co">#&gt; Average trade length   21                  17                 </span></span>
<span><span class="co">#&gt; Trade success %        100                 100                </span></span>
<span><span class="co">#&gt; Worst trade ret %      3.64                3.16               </span></span>
<span><span class="co">#&gt; ---------------------  "----------"        "----------"       </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   5.53                5.53               </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0302              0.0302             </span></span>
<span><span class="co">#&gt; Periods in market      178                 178                </span></span>
<span><span class="co">#&gt; ---------------------  "----------"        "----------"       </span></span>
<span><span class="co">#&gt; Direction              "long"              "long"             </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00 2020-04-19 23:00:00</span></span>
<span><span class="co">#&gt; End                    2020-12-23          2020-12-23         </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"               "TKR"              </span></span>
<span><span class="co">#&gt;                        [,3]               </span></span>
<span><span class="co">#&gt; Strategy               "senkouB &gt; kijun"  </span></span>
<span><span class="co">#&gt; ---------------------  "----------"       </span></span>
<span><span class="co">#&gt; Strategy cuml return % 14.1               </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0741             </span></span>
<span><span class="co">#&gt; Periods in market      64                 </span></span>
<span><span class="co">#&gt; Total trades           3                  </span></span>
<span><span class="co">#&gt; Average trade length   21.33              </span></span>
<span><span class="co">#&gt; Trade success %        100                </span></span>
<span><span class="co">#&gt; Worst trade ret %      3.49               </span></span>
<span><span class="co">#&gt; ---------------------  "----------"       </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   5.53               </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0302             </span></span>
<span><span class="co">#&gt; Periods in market      178                </span></span>
<span><span class="co">#&gt; ---------------------  "----------"       </span></span>
<span><span class="co">#&gt; Direction              "long"             </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00</span></span>
<span><span class="co">#&gt; End                    2020-12-23         </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"</span></span></code></pre></div>
<p>The output of <code><a href="../reference/autostrat.html">autostrat()</a></code> is a list of ichimoku objects.
Each object may be accessed by its position in the list
e.g. <code>[[1]]</code> for the first object.</p>
<p>The metadata is also saved as attributes to the list and can be
accessed by the function <code><a href="../reference/look.html">look()</a></code>:</p>
<ul>
<li><p><strong>logret</strong>: the log returns of all combinations
computed by autostrat</p></li>
<li><p><strong>summary</strong>: the strategy summaries</p></li>
</ul>
<p>Note: the strategies returned may not be in order of strategy returns
as displayed in the strategy summaries. This is due to the fact that the
implementation via <code><a href="../reference/mlgrid.html">mlgrid()</a></code> simultaneously tests all
strategies using the same time interval for comparability. However
individual strategies are then run on the top ‘n’ strategies using all
of the available data for those indicators, which may be more than that
used during comparison.</p>
<p>Note: as SenkouA, SenkouB, cloudT and cloudB are used in conjunction
with other indicators, it is possible to get a series of similar returns
with cloudB &gt; close, senkouB &gt; close etc. Although these
strategies may at times be equivalent or considered equivalent, this is
not always the case and all such results are returned.</p>
</div>
<div class="section level3">
<h3 id="autostrat-levels-2-and-3">
<code>autostrat()</code> Levels 2 and 3<a class="anchor" aria-label="anchor" href="#autostrat-levels-2-and-3"></a>
</h3>
<p>Set the argument <code>level = 2</code> to <code><a href="../reference/autostrat.html">autostrat()</a></code>
to test all strategies with a combination of up to 2 indicator
conditions, i.e. strat() with type = 2.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/autostrat.html">autostrat</a></span><span class="op">(</span><span class="va">cloud</span>, n <span class="op">=</span> <span class="fl">3</span>, dir <span class="op">=</span> <span class="st">"short"</span>, level <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        [,1]                               </span></span>
<span><span class="co">#&gt; Strategy               "close &gt; chikou &amp; tenkan &gt; senkouB"</span></span>
<span><span class="co">#&gt; ---------------------  "----------"                       </span></span>
<span><span class="co">#&gt; Strategy cuml return % 11.21                              </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0597                             </span></span>
<span><span class="co">#&gt; Periods in market      20                                 </span></span>
<span><span class="co">#&gt; Total trades           4                                  </span></span>
<span><span class="co">#&gt; Average trade length   5                                  </span></span>
<span><span class="co">#&gt; Trade success %        75                                 </span></span>
<span><span class="co">#&gt; Worst trade ret %      -0.44                              </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                       </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   -5.24                              </span></span>
<span><span class="co">#&gt; Per period mean ret %  -0.0302                            </span></span>
<span><span class="co">#&gt; Periods in market      178                                </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                       </span></span>
<span><span class="co">#&gt; Direction              "short"                            </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00                </span></span>
<span><span class="co">#&gt; End                    2020-12-23                         </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"                              </span></span>
<span><span class="co">#&gt;                        [,2]                              </span></span>
<span><span class="co">#&gt; Strategy               "high &gt; chikou &amp; tenkan &gt; senkouB"</span></span>
<span><span class="co">#&gt; ---------------------  "----------"                      </span></span>
<span><span class="co">#&gt; Strategy cuml return % 11.05                             </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0589                            </span></span>
<span><span class="co">#&gt; Periods in market      22                                </span></span>
<span><span class="co">#&gt; Total trades           4                                 </span></span>
<span><span class="co">#&gt; Average trade length   5.5                               </span></span>
<span><span class="co">#&gt; Trade success %        75                                </span></span>
<span><span class="co">#&gt; Worst trade ret %      0                                 </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                      </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   -5.24                             </span></span>
<span><span class="co">#&gt; Per period mean ret %  -0.0302                           </span></span>
<span><span class="co">#&gt; Periods in market      178                               </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                      </span></span>
<span><span class="co">#&gt; Direction              "short"                           </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00               </span></span>
<span><span class="co">#&gt; End                    2020-12-23                        </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"                             </span></span>
<span><span class="co">#&gt;                        [,3]                              </span></span>
<span><span class="co">#&gt; Strategy               "close &gt; chikou &amp; tenkan &gt; cloudB"</span></span>
<span><span class="co">#&gt; ---------------------  "----------"                      </span></span>
<span><span class="co">#&gt; Strategy cuml return % 10.69                             </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0571                            </span></span>
<span><span class="co">#&gt; Periods in market      24                                </span></span>
<span><span class="co">#&gt; Total trades           4                                 </span></span>
<span><span class="co">#&gt; Average trade length   6                                 </span></span>
<span><span class="co">#&gt; Trade success %        75                                </span></span>
<span><span class="co">#&gt; Worst trade ret %      -0.44                             </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                      </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   -5.24                             </span></span>
<span><span class="co">#&gt; Per period mean ret %  -0.0302                           </span></span>
<span><span class="co">#&gt; Periods in market      178                               </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                      </span></span>
<span><span class="co">#&gt; Direction              "short"                           </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00               </span></span>
<span><span class="co">#&gt; End                    2020-12-23                        </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"</span></span></code></pre></div>
<p>Set the argument <code>level = 3</code> to <code><a href="../reference/autostrat.html">autostrat()</a></code>
to test all strategies using an asymmetric combination of up to 2
indicator conditions, i.e. strat() with type = 3.</p>
<p>Note that level 3 autostrat is considered somewhat experimental as
the results will tend to have higher sensitivity to the data and in
particular the starting conditions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/autostrat.html">autostrat</a></span><span class="op">(</span><span class="va">cloud</span>, n <span class="op">=</span> <span class="fl">3</span>, dir <span class="op">=</span> <span class="st">"long"</span>, level <span class="op">=</span> <span class="st">"3"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        [,1]                             </span></span>
<span><span class="co">#&gt; Strategy               "senkouB &gt; senkouA x kijun &gt; low"</span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Strategy cuml return % 2.49                             </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0138                           </span></span>
<span><span class="co">#&gt; Periods in market      59                               </span></span>
<span><span class="co">#&gt; Total trades           3                                </span></span>
<span><span class="co">#&gt; Average trade length   19.67                            </span></span>
<span><span class="co">#&gt; Trade success %        66.67                            </span></span>
<span><span class="co">#&gt; Worst trade ret %      -2.49                            </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   5.53                             </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0302                           </span></span>
<span><span class="co">#&gt; Periods in market      178                              </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Direction              "long"                           </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00              </span></span>
<span><span class="co">#&gt; End                    2020-12-23                       </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"                            </span></span>
<span><span class="co">#&gt;                        [,2]                                </span></span>
<span><span class="co">#&gt; Strategy               "senkouB &gt; senkouA x tenkan &gt; kijun"</span></span>
<span><span class="co">#&gt; ---------------------  "----------"                        </span></span>
<span><span class="co">#&gt; Strategy cuml return % 6.98                                </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0379                              </span></span>
<span><span class="co">#&gt; Periods in market      82                                  </span></span>
<span><span class="co">#&gt; Total trades           3                                   </span></span>
<span><span class="co">#&gt; Average trade length   27.33                               </span></span>
<span><span class="co">#&gt; Trade success %        100                                 </span></span>
<span><span class="co">#&gt; Worst trade ret %      1.09                                </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                        </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   5.53                                </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0302                              </span></span>
<span><span class="co">#&gt; Periods in market      178                                 </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                        </span></span>
<span><span class="co">#&gt; Direction              "long"                              </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00                 </span></span>
<span><span class="co">#&gt; End                    2020-12-23                          </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"                               </span></span>
<span><span class="co">#&gt;                        [,3]                             </span></span>
<span><span class="co">#&gt; Strategy               "senkouB &gt; high x cloudT &gt; close"</span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Strategy cuml return % 15.15                            </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0793                           </span></span>
<span><span class="co">#&gt; Periods in market      98                               </span></span>
<span><span class="co">#&gt; Total trades           3                                </span></span>
<span><span class="co">#&gt; Average trade length   32.67                            </span></span>
<span><span class="co">#&gt; Trade success %        66.67                            </span></span>
<span><span class="co">#&gt; Worst trade ret %      -0.38                            </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Benchmark cuml ret %   5.53                             </span></span>
<span><span class="co">#&gt; Per period mean ret %  0.0302                           </span></span>
<span><span class="co">#&gt; Periods in market      178                              </span></span>
<span><span class="co">#&gt; ---------------------  "----------"                     </span></span>
<span><span class="co">#&gt; Direction              "long"                           </span></span>
<span><span class="co">#&gt; Start                  2020-04-19 23:00:00              </span></span>
<span><span class="co">#&gt; End                    2020-12-23                       </span></span>
<span><span class="co">#&gt; Ticker                 "TKR"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mlgrid">
<code>mlgrid()</code><a class="anchor" aria-label="anchor" href="#mlgrid"></a>
</h3>
<p>The ML layer provides tools for further developing quantitative
ichimoku solutions.</p>
<p><code><a href="../reference/mlgrid.html">mlgrid()</a></code> generates a numeric representation of the
relationship between ichimoku cloud chart elements, which represent a
set of stationary price features. Its purpose is to provide a base grid
for machine learning workflows.</p>
<p>The returned object is a data.frame or matrix in a ‘tidy’ format with
one observation per row and one feature per column with the target ‘y’
as the first column.</p>
<p><code><a href="../reference/mlgrid.html">mlgrid()</a></code> is used to power the <code><a href="../reference/autostrat.html">autostrat()</a></code>
and <code><a href="../reference/relative.html">relative()</a></code> functions.</p>
<p>The 3 basic types of grid are shown below.</p>
<p>‘boolean’ produces a ‘1’ or ‘0’ depending on whether the condition
c1_c2 (read c1 &gt; c2) is met:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mlgrid.html">mlgrid</a></span><span class="op">(</span><span class="va">cloud</span>, y <span class="op">=</span> <span class="st">"logret"</span>, dir <span class="op">=</span> <span class="st">"long"</span>, type <span class="op">=</span> <span class="st">"boolean"</span>, unique <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">100</span><span class="op">:</span><span class="fl">105</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                 y chikou_close chikou_high chikou_low</span></span>
<span><span class="co">#&gt; 2020-10-07 23:00:00  0.0083050685            1           1          1</span></span>
<span><span class="co">#&gt; 2020-10-08 23:00:00  0.0015026299            1           1          1</span></span>
<span><span class="co">#&gt; 2020-10-11 23:00:00  0.0022497197            1           1          1</span></span>
<span><span class="co">#&gt; 2020-10-12 23:00:00 -0.0014992507            1           1          1</span></span>
<span><span class="co">#&gt; 2020-10-13 23:00:00 -0.0007504691            1           1          1</span></span>
<span><span class="co">#&gt; 2020-10-14 23:00:00  0.0037467260            1           1          1</span></span></code></pre></div>
<p>‘numeric’ produces the numeric difference of c1 - c2:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mlgrid.html">mlgrid</a></span><span class="op">(</span><span class="va">cloud</span>, y <span class="op">=</span> <span class="st">"ret"</span>, dir <span class="op">=</span> <span class="st">"short"</span>, type <span class="op">=</span> <span class="st">"numeric"</span>, unique <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">100</span><span class="op">:</span><span class="fl">105</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                 y chikou_close chikou_high chikou_low</span></span>
<span><span class="co">#&gt; 2020-10-07 23:00:00 -0.0082706767          3.9         3.8        4.4</span></span>
<span><span class="co">#&gt; 2020-10-08 23:00:00 -0.0015015015          5.3         4.6        6.0</span></span>
<span><span class="co">#&gt; 2020-10-11 23:00:00 -0.0022471910          3.5         2.9        5.6</span></span>
<span><span class="co">#&gt; 2020-10-12 23:00:00  0.0015003751          5.0         3.7        6.4</span></span>
<span><span class="co">#&gt; 2020-10-13 23:00:00  0.0007507508          5.1         4.0        6.0</span></span>
<span><span class="co">#&gt; 2020-10-14 23:00:00 -0.0037397158          6.7         5.0        7.1</span></span></code></pre></div>
<p>‘z-score’ produces the standard score of a ‘numeric’ type grid:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mlgrid.html">mlgrid</a></span><span class="op">(</span><span class="va">cloud</span>, y <span class="op">=</span> <span class="st">"ret"</span>, dir <span class="op">=</span> <span class="st">"short"</span>, type <span class="op">=</span> <span class="st">"z-score"</span>, unique <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">100</span><span class="op">:</span><span class="fl">105</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                 y chikou_close chikou_high chikou_low</span></span>
<span><span class="co">#&gt; 2020-10-07 23:00:00 -0.0082706767    0.4046813   0.5057896  0.3499295</span></span>
<span><span class="co">#&gt; 2020-10-08 23:00:00 -0.0015015015    0.6349143   0.6370076  0.6106195</span></span>
<span><span class="co">#&gt; 2020-10-11 23:00:00 -0.0022471910    0.3389004   0.3581693  0.5454470</span></span>
<span><span class="co">#&gt; 2020-10-12 23:00:00  0.0015003751    0.5855786   0.4893873  0.6757920</span></span>
<span><span class="co">#&gt; 2020-10-13 23:00:00  0.0007507508    0.6020238   0.5385941  0.6106195</span></span>
<span><span class="co">#&gt; 2020-10-14 23:00:00 -0.0037397158    0.8651473   0.7026165  0.7898439</span></span></code></pre></div>
<p>Note: only valid combinations are included within the grid. Any
combination involving ‘open’ is excluded as it is in effect a lagged
indicator and not contemporaneous. The following trivial or
highly-collinear pairs are also excluded: {high, close} ,{low, close},
{low, high}, {cloudT, senkouA}, {cloudB, senkouA}, {cloudT, senkouB},
{cloudB, senkouB}, {cloudB, cloudT}.</p>
<p>The parameter ‘unique’ defaults to TRUE to return only unique
combinations of c1 and c2, but can also be set to FALSE to return both
c1 &gt; c2 and c2 &gt; c1 where the situation merits.</p>
<p>The ‘y’ column can be switched between log and discrete returns. The
date-time index corresponds to when the condition is met at the close
for that period. The return is the single-period return achieved by
transacting at the immediately following opening price until the next
opening price. In this sense, the time periods do not strictly match,
but are nevertheless correctly paired.</p>
<p>The calculation of the returns and correct pairing effectively uses
up 2 periods, hence in order to obtain the grid for the latest available
price data, y must be set to ‘none’, in which case a grid is returned
without the target variable.</p>
</div>
<div class="section level3">
<h3 id="relative">
<code>relative()</code><a class="anchor" aria-label="anchor" href="#relative"></a>
</h3>
<p>Produces a statistical summary of the latest numeric representation
of the ichimoku cloud chart relative to historical values contained
within the ichimoku object. This can aid in determining whether current
trading falls within or outside of normal ranges.</p>
<p>Takes the following optional arguments:</p>
<ul>
<li>
<code>order</code> [default FALSE] set to TRUE to order the results
by the absolute ‘z-score’. Those with the highest values are listed
first</li>
<li>
<code>signif</code> [default 0.2] set a significance threshold for
which if ‘p’ is equal or lower, the element will be starred with a ’*’.
Note: this value may be freely set and the default of 0.2 is arbitrary
with no special significance</li>
<li>
<code>quietly</code> if set to TRUE, will suppress printing of
additional output to the console and return quietly</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/relative.html">relative</a></span><span class="op">(</span><span class="va">cloud</span>, signif <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span><span class="co">#&gt; Latest: 2020-12-24 00:00:00 | n: 155</span></span>
<span><span class="co">#&gt;                mean(X) sd(X) X[n]   res z-score p &gt;= |z| p* E(|res|)|p</span></span>
<span><span class="co">#&gt; chikou_close      1.51  6.07 7.00  5.49    0.91     0.39  *       8.53</span></span>
<span><span class="co">#&gt; chikou_high       0.79  6.09 6.60  5.81    0.95     0.36  *       8.91</span></span>
<span><span class="co">#&gt; chikou_low        2.31  6.12 7.80  5.49    0.90     0.41          8.40</span></span>
<span><span class="co">#&gt; chikou_tenkan     1.73  6.15 6.90  5.17    0.84     0.41          8.70</span></span>
<span><span class="co">#&gt; chikou_kijun      2.28  5.96 4.90  2.62    0.44     0.63          6.84</span></span>
<span><span class="co">#&gt; chikou_senkouA    3.44  6.46 4.75  1.31    0.20     0.89          6.26</span></span>
<span><span class="co">#&gt; chikou_senkouB    4.26  5.40 4.35  0.09    0.02     1.00          4.76</span></span>
<span><span class="co">#&gt; chikou_cloudT     2.67  6.44 4.35  1.68    0.26     0.84          6.59</span></span>
<span><span class="co">#&gt; chikou_cloudB     5.03  5.20 4.75 -0.28   -0.05     0.99          4.60</span></span>
<span><span class="co">#&gt; close_tenkan      0.52  1.77 1.70  1.18    0.67     0.52          2.19</span></span></code></pre></div>
<p>‘mean(X)’ is the mean value for each element X, ‘sd(X)’ the standard
deviation, and ‘X[n]’ the nth or latest observed values.</p>
<p>‘res’ is the residual X[n] - mean(X) and represents a centred measure
of deviation for the latest observed value.</p>
<p>The ‘z-score’ (or standard score) is calculated as res / sd(X) and is
a centred and scaled measure of deviation for the latest observed
value.</p>
<p>‘p &gt;= |z|’ represents the empirical probability of the latest
observed absolute ‘z-score’ or greater.</p>
<p>’p*’ will display a star if ‘p &gt;= |z|’ is less than or equal to
the value of the argument ‘signif’.</p>
<p>‘E(|res|)|p’ represents the mean or expected absolute value of ‘res’,
conditional upon the absolute ‘z-score’ being greater than equal to the
latest observed absolute ‘z-score’. This provides an indication by how
much ‘res’ might increase in more extreme cases.</p>
</div>
</div>
<div class="section level2">
<h2 id="strategy-summary-specification">Strategy Summary Specification<a class="anchor" aria-label="anchor" href="#strategy-summary-specification"></a>
</h2>
<p><code>---</code></p>
<p><strong>Strategy cuml return %</strong>: The (discrete) percentage
return achieved by pursuing the strategy, assuming all returns are
compounded. This measure is equivalent to the sum of log returns
converted back into a discrete return</p>
<p><strong>Per period mean ret %</strong>: The percentage return (above)
divided by the periods in market (below)</p>
<p><strong>Periods in market</strong>: The number of periods (days, or
whatever the periodicity of the data is) in the market</p>
<p><strong>Total trades</strong>: Total number of trades to implement
the strategy. Note that each trade requires 2 transactions, one to enter
the trade and one to exit. Note: generating the benchmark return would
imply one trade</p>
<p><strong>Average trade length</strong>: Periods in Market (above)
divided by total trades (above)</p>
<p><strong>Trade success %</strong>: Number of trades where the return
is strictly greater than zero divided by the total number of trades</p>
<p><strong>Worst trade ret %</strong>: The (discrete) percentage return
of the worst-performing trade</p>
<p><code>---</code></p>
<p><strong>Benchmark cuml return %</strong>: The (discrete) percentage
return achieved using a ‘buy and hold’ strategy</p>
<p><strong>Per period mean ret %</strong>: The percentage return (above)
divided by the periods in market (below)</p>
<p><strong>Periods in market</strong>: The number of periods (days, or
whatever the periodicity of the data is) from the ‘start’ to ‘end’
dates</p>
<p><code>---</code></p>
<p><strong>Ticker</strong>: The ticker saved in the ichimoku object</p>
<p><strong>Start/end</strong>: The start and end dates of the backtest.
These dates will differ for different cloud lines depending on how many
periods it takes to calculate them</p>
<p><strong>Direction</strong>: ‘long’ or ‘short’ trade direction as can
be set via the argument ‘dir’. Only single direction strategies are
considered</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Sasaki, H. 佐々木 英信 (1996), <em>一目均衡表の研究 [ichimoku
kinkouhyou no kenkyuu]</em>. Tokyo, Japan: Toushi Radar.</p>
<hr>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charlie Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
